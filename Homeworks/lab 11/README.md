# Лабораторная работа. Настройка и проверка расширенных списков контроля доступа.

## Топопология

![](1.jpg)

## Таблица адресации

| Устройство    | Интерфейс   | IP-адрес  | Маска подсети | Шлюз по умолчанию |
|-----------------|---------------|-------------------------|-------------------|---------|
| R1 | G0/0/1   | -  |   -   | - |
| R1 | G0/0/1.20   | 10.20.0.1|    255.255.255.0  | - |
| R1 | G0/0/1.30   | 10.30.0.1|    255.255.255.0  | - |
| R1 | G0/0/1.40 | 10.40.0.1 |   255.255.255.0  | - |
| R1 | G0/0/1.1000     | - |    -  | - |
| R1 | Loopback1      | 172.16.1.1 |    255.255.255.0  | - |
| R2 | G0/0/1      | 10.20.0.4 |    255.255.255.0  | - |
| S1 | VLAN 20     | 10.20.0.2 |    255.255.255.0  | 10.20.0.1 |
| S2 | VLAN 20      | 10.20.0.3 |    255.255.255.0  | 10.20.0.1 |
| PC-A | NIC     | 10.30.0.10 |    255.255.255.0  | 10.30.0.1 |
| PC-B | NIC      | 10.40.0.10 |    255.255.255.0  | 10.40.0.1 |

## Таблица VLAN

| VLAN   | Имя   | Назаначение интерфейса  |
|-----------------|---------------|-------------------------|
| 20 | Management   | S2: F0/5   |
| 30 | Operations   | S1: F0/6  |
| 40 | Sales  | S2: F0/18 |
| 999 | ParkingLot   | S1: F0/2-4, F0/7-24, G0/1-2 |
| 999 | ParkingLot   | S2: F0/2-4, F0/6-17, F0/19-24, G0/1-2| 
| 1000 | Собственная | - |

### Задачи

Часть 1. Создание сети и настройка основных параметров устройства

Часть 2. Настройка и проверка списков расширенного контроля доступа

## Решение

# Часть 1. Создание сети и настройка основных параметров устройства

## Шаг 1. Создайте сеть согласно топологии.

![](1.PNG)

## Шаг 2. Произведите базовую настройку маршрутизаторов.

Настройку произвел как и в предыдущих практических работах 

## Шаг 3. Настройте базовые параметры каждого коммутатора.

Настройку произвел как и в предыдущих практических работах 

# Часть 2. Настройка сетей VLAN на коммутаторах.

## Шаг 1. Создайте сети VLAN на коммутаторах.

* Создайте необходимые VLAN и назовите их на каждом коммутаторе из приведенной выше таблицы.

![](2.PNG)

* Настройте интерфейс управления и шлюз по умолчанию на каждом коммутаторе, используя информацию об IP-адресе в таблице адресации.

![](3.PNG)

* Назначьте все неиспользуемые порты коммутатора VLAN Parking Lot, настройте их для статического режима доступа и административно деактивируйте их.

![](4.PNG)

## Шаг 2. Назначьте сети VLAN соответствующим интерфейсам коммутатора.

* Назначьте используемые порты соответствующей VLAN (указанной в таблице VLAN выше) и настройте их для режима статического доступа.

![](5.PNG)

* Выполните команду show vlan brief, чтобы убедиться, что сети VLAN назначены правильным интерфейсам.

![](6.PNG)

# Часть 3. Настройте транки (магистральные каналы).

## Шаг 1. Вручную настройте магистральный интерфейс F0/1.

* Измените режим порта коммутатора на интерфейсе F0/1, чтобы принудительно создать магистральную связь. Не забудьте сделать это на обоих коммутаторах.

![](27.PNG)

* В рамках конфигурации транка установите для native vlan значение 1000 на обоих коммутаторах. При настройке двух интерфейсов для разных собственных VLAN сообщения об ошибках могут отображаться временно.

![](8.PNG)

* В качестве другой части конфигурации транка укажите, что VLAN 10, 20, 30 и 1000 разрешены в транке.

![](9.PNG)

* Выполните команду show interfaces trunk для проверки портов магистрали, собственной VLAN и разрешенных VLAN через магистраль.

![](10.PNG)

## Шаг 2. Вручную настройте магистральный интерфейс F0/5 на коммутаторе S1.

* Настройте интерфейс S1 F0/5 с теми же параметрами транка, что и F0/1. Это транк до маршрутизатора.

![](11.PNG)

# Часть 4. Настройте маршрутизацию.

## Шаг 1. Настройка маршрутизации между сетями VLAN на R1.

* Активируйте интерфейс G0/0/1 на маршрутизаторе.

![](12.PNG)

* Настройте подинтерфейсы для каждой VLAN, как указано в таблице IP-адресации. Все подинтерфейсы используют инкапсуляцию 802.1Q. Убедитесь, что подинтерфейс для собственной VLAN не имеет назначенного IP-адреса. Включите описание для каждого подинтерфейса.

![](13.PNG)

* Настройте интерфейс Loopback 1 на R1 с адресацией из приведенной выше таблицы.

![](14.PNG)

* С помощью команды show ip interface brief проверьте конфигурацию подынтерфейса.

![](15.PNG)

## Шаг 2. Настройка интерфейса R2 g0/0/1 с использованием адреса из таблицы и маршрута по умолчанию с адресом следующего перехода 10.20.0.1

![](16.PNG)

# Часть 5. Настройте удаленный доступ

## Шаг 1. Настройте все сетевые устройства для базовой поддержки SSH.

* Создайте локального пользователя с именем пользователя SSHadmin и зашифрованным паролем $cisco123!

![](17.PNG)

* Используйте ccna-lab.com в качестве доменного имени.

![](18.PNG)

* Генерируйте криптоключи с помощью 1024 битного модуля.

![](19.PNG)

* Настройте первые пять линий VTY на каждом устройстве, чтобы поддерживать только SSH-соединения и с локальной аутентификацией.

![](20.PNG)

## Шаг 2. Включите защищенные веб-службы с проверкой подлинности на R1.

В cpt отсутствует команда ip http secure-server.

## Часть 6. Проверка подключения

## Шаг 1. Настройте узлы ПК.

![](23.PNG)

## Шаг 2. Выполните тесты на доступ узлов

![](21.PNG)

![](22.PNG)

Все тесты прошли успешно, за исключением тестов связанных с протоколом https.

# Часть 7. Настройка и проверка списков контроля доступа (ACL)

* Политика1. Сеть Sales не может использовать SSH в сети Management (но в  другие сети SSH разрешен).

* Политика 2. Сеть Sales не имеет доступа к IP-адресам в сети Management с помощью любого веб-протокола (HTTP/HTTPS). Сеть Sales также не имеет доступа к интерфейсам R1 с помощью любого веб-протокола. Разрешён весь другой веб-трафик (обратите внимание — Сеть Sales  может получить доступ к интерфейсу Loopback 1 на R1).

* Политика3. Сеть Sales не может отправлять эхо-запросы ICMP в сети Operations или Management. Разрешены эхо-запросы ICMP к другим адресатам.
  
* Политика 4: Cеть Operations  не может отправлять ICMP эхозапросы в сеть Sales. Разрешены эхо-запросы ICMP к другим адресатам.

С учетом вышеописаных политик я разработал следующий список доступа

![](24.PNG)

Тесты заявленные в работе пройдены успешно за исключением тестов связанных с протоколом https

![](25.PNG)

![](26.PNG)
