# Лабораторная работа - Настройка NAT для IPv4

## Топопология

![](1.jpg)

## Таблица адресации

| Устройство    | Интерфейс   | IP-адрес  | Маска подсети |
|-----------------|---------------|-------------------------|-------------------|
| R1 | G0/0/0  | 209.165.200.230 |   255.255.255.248   | 
| R1 | G0/0/1  | 192.168.1.1 |    255.255.255.0  |
| R2 | G0/0/0   | 209.165.200.225 |    255.255.255.248  |
| R2 | Lo1 | 209.165.200.1 |    255.255.255.224  |
| S1 | VLAN 1     | 192.168.1.11 |    255.255.255.0  | 
| S2 | VLAN 1     | 192.168.1.12 |    255.255.255.0  | 
| PC-A | NIC      | 192.168.1.2 |    255.255.255.0  | 
| PC-B | NIC      | 192.168.1.3 |    255.255.255.0  | 

### Задачи

Часть 1. Создание сети и настройка основных параметров устройства

Часть 2. Настройка и проверка NAT для IPv4

Часть 3. Настройка и проверка PAT для IPv4

Часть 4. Настройка и проверка статического NAT для IPv4.

## Решение

# Часть 1. Создание сети и настройка основных параметров устройства

## Шаг 1. Подключите кабели сети согласно приведенной топологии.

![](1.PNG)

## Шаг 2. Произведите базовую настройку маршрутизаторов.

* Назначьте маршрутизатору имя устройства.

![](2.PNG)

* Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.

![](3.PNG)

* Назначьте class в качестве зашифрованного пароля привилегированного режима EXEC.

![](4.PNG)

* Назначьте cisco в качестве пароля консоли и включите вход в систему по паролю.

![](5.PNG)

* Назначьте cisco в качестве пароля VTY и включите вход в систему по паролю.

![](6.PNG)

* Зашифруйте открытые пароли.

![](7.PNg)

* Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.

![](8.PNG)

* Настройте IP-адресации интерфейса, как указано в таблице выше.

![](9.PNG)

* Настройте маршрут по умолчанию. от R2 до  R1.

![](10.PNG)

* Сохраните текущую конфигурацию в файл загрузочной конфигурации.

![](11.PNG)

На R2 были произведены теже настройки, поменялись только ip-адреса!

![](N12.PNG)

## Шаг 3. Настройте базовые параметры каждого коммутатора.

* Присвойте коммутатору имя устройства.

![](12.PNG)

* Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.

![](13.PNG)

* Назначьте class в качестве зашифрованного пароля привилегированного режима EXEC.

![](14.PNG)

* Назначьте cisco в качестве пароля консоли и включите вход в систему по паролю.

![](15.PNG)

* Назначьте cisco в качестве пароля VTY и включите вход в систему по паролю.

![](16.PNG)

* Зашифруйте открытые пароли.

![](17.PNG)

* Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.

![](18.PNG)

* Выключите все интерфейсы, которые не будут использоваться.

![](19.PNG)

* Настройте IP-адресации интерфейса, как указано в таблице выше.

![](20.PNG)

* Сохраните текущую конфигурацию в файл загрузочной конфигурации.

![](21.PNG)

На S2 были произведены теже настройки, поменялись только ip-адреса и были заглушены другие порты!

![](22.PNG)

# Часть 2. Настройка и проверка NAT для IPv4.

## Шаг 1. Настройте NAT на R1, используя пул из трех адресов 209.165.200.226-209.165.200.228.

* Настройте простой список доступа, который определяет, какие хосты будут разрешены для трансляции. В этом случае все устройства в локальной сети R1 имеют право на трансляцию.

![](23.PNG)

* Создайте пул NAT и укажите ему имя и диапазон используемых адресов.

![](24.PNG)

* Настройте перевод, связывая ACL и пул с процессом преобразования.

![](25.PNG)

* Задайте внутренний (inside) интерфейс.

![](26.PNG)

* Определите внешний (outside) интерфейс.

![](27.PNG)

## Шаг 2. Проверка конфигурации.

* С PC-B,  запустите эхо-запрос интерфейса Lo1 (209.165.200.1) на R2. Если эхо-запрос не прошел, выполните процес поиска и устранения неполадок. На R1 отобразите таблицу NAT на R1 с помощью команды show ip nat translations.

![](28.PNG)

Во что был транслирован внутренний локальный адрес PC-B? - 209.165.200.226

Какой тип адреса NAT является переведенным адресом? - Inside Global

* С PC-A, запустите  эхо-запрос интерфейса Lo1 (209.165.200.1) на R2. Если эхо-запрос не прошел, выполните отладку. На R1 отобразите таблицу NAT на R1 с помощью команды show ip nat translations.

![](29.PNG)

* Обратите внимание, что предыдущая трансляция для PC-B все еще находится в таблице. Из S1, эхо-запрос интерфейса Lo1 (209.165.200.1) на R2. Если эхо-запрос не прошел, выполните отладку. На R1 отобразите таблицу NAT на R1 с помощью команды show ip nat translations.

![](30.PNG)

* Теперь запускаем пинг R2 Lo1 из S2. На этот раз перевод завершается неудачей, и вы получаете эти сообщения (или аналогичные) на консоли R1:

![](31.PNG)

* Это ожидаемый результат, потому что выделено только 3 адреса, и мы попытались ping Lo1 с четырех устройств. Напомним, что NAT — это трансляция «один-в-один». Как много выделено трансляций? Введите команду show ip nat translations verbose , и вы увидите, что ответ будет 24 часа.

В cpt данная команда отсутствует

* Учитывая, что пул ограничен тремя адресами, NAT для пула адресов недостаточно для нашего приложения. Очистите преобразование NAT и статистику, и мы перейдем к PAT.

![](32.PNG)

clear ip nat statistics - Команда отсутствует в cpt

# Часть 3. Настройка и проверка PAT для IPv4.

## Шаг 1. Удалите команду преобразования на R1.

![](33.PNG)

## Шаг 2. Добавьте команду PAT на R1.

![](34.PNG)

## Шаг 3. Протестируйте и проверьте конфигурацию.


